/*! webapp 25-12-2014 */

$(function(){"use strict";var a,b=$('[role="tablist"]'),c=$(".choose-iframe-select"),d=$(".notifications"),e=$('[data-span="notificationTxt"]'),f=function(a,b){return"href"===b?a.getAttribute(b).split("#")[1]:a.getAttribute(b)},g=function(a){a.addClass("active").attr("aria-selected","true").removeAttr("aria-hidden")},h=function(a){a.removeClass("active").attr("aria-hidden","true").removeAttr("aria-selected")},i=function(a){var b=/(([a-z]{4,6}:\/\/)|(^|\s))([a-zA-Z0-9\-]+\.)+[a-z]{2,13}[\.\?\=\&\%\/\w\-]*\b([^@]|$)/;return b.test(a)},j=function(){return Modernizr.localstorage?!0:(console.error("Your browser does not support localStorage"),!1)},k=function(a){j()&&localStorage.setItem("reports",JSON.stringify(a))},l=function(){var a=localStorage.getItem("reports");if(!j())return!1;try{a=JSON.parse(a)}catch(b){console.error("The saved data was not in a valid JSON format")}return a||(a={}),a},m=function(){var a=l();$("form").each(function(a,b){$(b).find("input").each(function(a,b){$(b).val("")})}),$.each(a,function(b){if(a.hasOwnProperty(b)){var c=$('[data-settings="'+b+'"] fieldset [type="text"]'),d=$('[data-settings="'+b+'"] fieldset [type="url"]');$(a[b]).each(function(a,b){b.name&&b.url&&(c[a].value=b.name,d[a].value=b.url)}),u({target:$('[data-form="'+b+'"]').eq(0)[0]})}})},n=function(a){a.preventDefault();var i=a.target.value,j=!1;13===a.keyCode&&(c.each(function(a,b){var c=$(b).find("option"),d=f(b,"data-select");c.each(function(a,c){var e=c.text.indexOf(i),f=c.value;return e>-1?(h($('div[role="tabpanel"]')),h($('a[role="tab"]')),g($('[data-link="'+d+'"]')),g($('[data-div="'+d+'"]')),b.selectedIndex=a,$('[data-iframe="'+d+'"]').attr("src",f),void(j=!0)):void 0})}),j||(d.hasClass("hidden")?(d.removeClass("hidden"),b.css({top:"330px"}),e.html("The searched report <b>"+i+"</b> was not found")):e.html("The searched report <b>"+i+"</b> was not found")))},o=function(){var a=$('a[role="tab"]'),b=$('li a[href="'+location.hash.replace("panel-","")+'"]');""===location.hash&&(b[0]=a[0]),p({target:b[0]})},p=function(a){a.preventDefault&&a.preventDefault();var b=a.target,c=f(b,"href"),d=$("#"+c+" input").eq(0);location.hash="panel-"+c.replace("#",""),h($('div[role="tabpanel"]')),h($('a[role="tab"]')),g($('a[href="#'+c+'"]')),g($("#"+c)),(13===a.keyCode||32===a.keyCode)&&(location.hash="panel-"+c.replace("#","")),d&&(""===d.val()?d.focus():d.blur())},q=function(a){var b=a.currentTarget,c=f(b,"data-settings");27===a.keyCode&&($(b).addClass("hidden"),$('[data-btn="'+c+'"]').removeClass("active"),$('[data-settings="'+c+'"]').removeClass("active").hasClass("hidden"))},r=function(a){a.preventDefault();var b=a.target,c=f(b,"data-btn"),d=$('[data-settings="'+c+'"]');d.toggleClass("hidden"),$(b).toggleClass("active")},s=function(a){a.preventDefault();var b=a.target,c=f(b,"data-link");$('[data-settings="'+c+'"]').addClass("hidden").hasClass("hidden"),$('[data-btn="'+c+'"]').removeClass("active")},t=function(a){a.preventDefault(),m(),s(a)},u=function(a){a.preventDefault&&a.preventDefault();var b=!1,c=!0,d=a.target,e=f(d,"data-form"),g=$('[data-select="'+e+'"]'),h=$('[data-settings="'+e+'"] fieldset'),j=[],m=l(),n=0;g.empty(),0===j.length&&($('[data-selectContainer="'+e+'"]').addClass("hidden"),$('[data-iframe="'+e+'"]').addClass("hidden"),$('[data-expand="'+e+'"]').addClass("hidden")),h.each(function(a,d){var f=$(d.getElementsByTagName("INPUT")[0]),k=f.val(),l=$(d.getElementsByTagName("INPUT")[1]),m=l.val();if(b=!1,""===k&&""===m&&(n++,n===h.size()&&($(h.eq(0).find("input")[0]).addClass("error").focus(),b=!1,c=!1,localStorage.clear())),f.removeClass("error"),l.removeClass("error"),""===k&&""!==m)return f.addClass("error").focus(),b=!1,void(c=!1);if(""!==m&&-1===m.indexOf("http://")&&(m="http://"+m),(""===m||!i(m))&&""!==k)return l.addClass("error").focus(),b=!1,void(c=!1);if(""!==k&&i(m)&&(l.removeClass("error"),b=!0),b){$('[data-btn="'+e+'"]').removeClass("active"),$('[data-settings="'+e+'"]').hasClass("hidden");var o=$("<option>");o.html(k).val(m),g.append(o),$('[data-expand="'+e+'"]').removeClass("hidden"),$('[data-selectContainer="'+e+'"]').removeClass("hidden"),$('[data-iframe="'+e+'"]').removeClass("hidden")}else k="",m="";j.push({name:k,url:m})}),j.length>0&&(m[e]=j,k(m),v(e,g.children().size()-1),c&&$('[data-settings="'+e+'"]').addClass("hidden"))},v=function(a,b){"object"==typeof a&&(a=f(a.target,"data-select"));var c=$('[data-select = "'+a+'"]').get()[0],d=c.options[b?b:c.selectedIndex],e=d&&d.value;e&&(b&&(c.selectedIndex=b),$('[data-iframe="'+a+'"]').attr("src",e))},w=function(a){a.preventDefault();var b=a.target,c=f(b,"data-expand"),d=$('[data-iframe="'+c+'"]').attr("src");$('[data-iframe="'+c+'"]').hasClass("hidden")||(window.open(d,"_blank"),window.focus())};a=function(){$.getJSON("/"+(location.href.indexOf("github.io")>0?"webapp/":"")+"data/config.json",function(){}).done(function(a){if(a){var c,f,g,h,i,j,k=a.notification,l=a.quickActions,m=a.tabsList;d.removeClass("hidden"),e.html(k),b.css({top:"330px"}),c=$("#navTmpl").html(),f=Handlebars.compile(c),g=f(l),$("#nav").html(g),h=$("#tabsTmpl").html(),i=Handlebars.compile(h),j=i(m),$("#tabs").html(j),console.log(m[0].options)}}).fail(function(a){console.log(a)}),o(),m()}(),$(".tab-headers").on("click keypress",p),$(window).on("hashchange",o),$('input[name="q"]').on("keyup",n),$(".action-btn.settings").on("click",r),$(".link.cancel-form").on("click",t),$(".btn.btn__submit-form").on("click",u),$(".tab-content-settings").on("keyup",q),$(".choose-iframe-select").on("change",v),$(".action-btn.expand").on("click",w)});
//# sourceMappingURL=main.min.js.map